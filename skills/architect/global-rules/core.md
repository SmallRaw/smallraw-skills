# 核心规则

> 这些规则适用于所有项目，不可违反，不可覆盖。
> 安装位置: ~/.claude/rules/core.md

---

## Git 安全

- **MUST** 禁止使用 `git add .` 或 `git add -A`
  为什么：可能意外提交敏感文件（.env、credentials）或大文件。
  正确做法：明确指定要提交的文件，或使用 `scripts/committer`。

- **MUST** 禁止编辑 `node_modules`（或任何包管理器的依赖目录）
  为什么：下次 install 会覆盖你的改动。
  正确做法：使用 patch-package 或 fork 依赖。

- **MUST** 禁止提交敏感信息
  包括：API keys、密码、tokens、真实手机号、真实邮箱、私钥。
  为什么：一旦进入 git 历史，很难完全清除。
  正确做法：使用 placeholder，确保 .gitignore 正确配置。

---

## 版本控制行为

- **MUST** 禁止 `git push --force` 到 main/master
  为什么：会覆盖他人的工作。
  正确做法：使用 `--force-with-lease` 或先沟通。

- **MUST** 禁止未经批准修改版本号
  为什么：版本号影响发布，误改可能导致问题。
  正确做法：修改版本号前获得明确批准。

- **MUST** 禁止未经批准执行发布命令
  包括：npm publish、docker push、deploy 等。
  为什么：发布是不可逆操作。
  正确做法：发布前明确确认。

---

## 代码行为

- **MUST** 不要猜测答案
  为什么：错误的信息比没有信息更糟糕。
  正确做法：先验证代码，不确定就说不确定。

- **MUST** 推送前确保测试通过
  为什么：避免 CI 失败浪费时间。
  正确做法：`pnpm test` 或等效命令。

---

## 外部操作

- **MUST** 外部操作前询问
  包括：发送邮件、发推文、公开发布、调用付费 API。
  为什么：外部操作可能有不可预期的影响。
  正确做法：描述要做什么，等待确认。

---

## 这些规则不可覆盖

项目规则（AGENTS.md）可以**扩展**这些规则，但不能**削弱**。

例如：
- ✅ 允许：项目规定"禁止使用任何 git add 命令"（更严格）
- ❌ 禁止：项目规定"可以使用 git add ."（削弱核心规则）
